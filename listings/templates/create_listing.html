<!-- {% extends "base.html" %}

{% block title %}Create Listing{% endblock %}

{% block content %}
<h1>Create New Listing</h1>

{% if messages %}
    {% for message in messages %}
        <p style="color: red;">{{ message }}</p>
    {% endfor %}
{% endif %}

<!-- SHOW FORM ERRORS -->
<!-- {% if form.errors %}
    <div style="background: #ffcccc; padding: 10px; margin: 10px 0;">
        <h3>Form Errors:</h3>
        {{ form.errors }}
    </div>
{% endif %}

{% if image_formset.errors %}
    <div style="background: #ffcccc; padding: 10px; margin: 10px 0;">
        <h3>Image Formset Errors:</h3>
        {{ image_formset.errors }}
    </div>
{% endif %}

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    
    {% for field in form %}
        <div>
            {{ field.label_tag }}
            {{ field }}
            {% if field.errors %}
                <p style="color: red;">{{ field.errors }}</p>
            {% endif %}
        </div>
    {% endfor %}
    
    <h3>Images (Optional)</h3>
    {{ image_formset.management_form }}
    {% for image_form in image_formset %}
        {{ image_form.as_p }}
        <hr>
    {% endfor %}
    
    <button type="submit">Create Listing</button>
    <a href="{% url 'listings:all_listings_page' %}">Cancel</a>
</form>

{% endblock %} --> -->

<div class="create-listing-container">

    <h1>Create New Listing</h1>

    {% if messages %}
        {% for message in messages %}
            <div class="form-global-message form-error-msg">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {% for field in form %}
        <div class="form-field">
            {{ field.label_tag }}
            {{ field }}
            {% if field.errors %}
                <p class="field-error">{{ field.errors }}</p>
            {% endif %}
        </div>
        {% endfor %}

        <h3 class="image-section-title">Images (Optional)</h3>
        {{ image_formset.management_form }}

        {% for image_form in image_formset %}
        <div class="image-form-block">
            {{ image_form.as_p }}
            <hr>
        </div>
        {% endfor %}

        <button type="submit">Create Listing</button>
        <a href="{% url 'listings:all_listings_page' %}" class="form-cancel-link">Cancel</a>
    </form>

</div>
