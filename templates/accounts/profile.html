{% extends "base.html" %}

{% block title %}{% if is_own_profile %}My Profile{% else %}{{ profile_user.username }}'s Profile{% endif %} - PC Marketplace{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 50px auto; padding: 20px;">
    
    <div style="background: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div>
                <h1 style="color: #666; margin: 0 0 10px 0;">{{ profile_user.username }}</h1>
                
                <p style="color: #666; margin-top: 10px;">
                    Member since: {{ profile_user.date_joined|date:"F Y" }}
                </p>
                
                {% if is_own_profile and profile_user.email %}
                    <p style="color: #666; margin-top: 5px;">
                        Email: {{ profile_user.email }}
                    </p>
                {% endif %}
            </div>
        </div>
    </div>

    <div style="background: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h2>{% if is_own_profile %}Your{% else %}{{ profile_user.username }}'s{% endif %} Listings ({{ listings.count }})</h2>
        
        {% if listings %}
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
                {% for listing in listings %}
                    <div style="border: 1px solid #ddd; border-radius: 8px; overflow: hidden; transition: box-shadow 0.3s;">
                        {% if listing.images.first %}
                            <img src="{{ listing.images.first.image.url }}" 
                                style="width: 100%; height: 200px; object-fit: cover;" 
                                alt="{{ listing.title }}">
                        {% else %}
                            <div style="width: 100%; height: 200px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; color: #999;">
                                No Image
                            </div>
                        {% endif %}
                        
                        <div style="padding: 15px;">
                            <h3 style="margin: 0 0 10px 0; font-size: 18px;">{{ listing.title }}</h3>
                            <p style="font-size: 22px; color: #28a745; font-weight: bold; margin: 10px 0;">
                                ${{ listing.price }}
                            </p>
                            <p style="color: #666; margin: 5px 0;">
                                <strong>Condition:</strong> {{ listing.get_condition_display }}
                            </p>
                            <p style="color: #666; margin: 5px 0;">
                                <strong>Stock:</strong> {{ listing.stock }}
                            </p>
                            
                            <a href="{% url 'listings:load_listing_detail' l_id=listing.id %}" 
                            style="display: inline-block; width: 100%; text-align: center; padding: 10px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; margin-top: 15px;">
                                View Details
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p style="color: #666; margin-top: 20px; text-align: center; padding: 40px;">
                {% if is_own_profile %}
                    You haven't created any listings yet.
                    <br><br>
                    <a href="{% url 'listings:select_p_type_new' %}" 
                    style="display: inline-block; padding: 12px 25px; background: #28a745; color: white; text-decoration: none; border-radius: 5px;">
                        + Create Your First Listing
                    </a>
                {% else %}
                    {{ profile_user.username }} hasn't created any listings yet.
                {% endif %}
            </p>
        {% endif %}
    </div>

    <div style="margin-top: 20px;">
        <a href="{% url 'homepage' %}" 
        style="display: inline-block; padding: 10px 20px; background: #6c757d; color: white; text-decoration: none; border-radius: 5px; margin-right: 10px;">
                Back to Home
        </a>
        
        {% if is_own_profile %}
            <a href="{% url 'listings:my_listings' %}" 
            style="display: inline-block; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; margin-right: 10px;">
                Manage Listings
            </a>
            <a href="{% url 'accounts:logout' %}" 
            style="display: inline-block; padding: 10px 20px; background: #dc3545; color: white; text-decoration: none; border-radius: 5px;">
                Logout
            </a>
        {% endif %}
    </div>
</div>
{% endblock %}